# 代理模式
类型：结构型设计模式

定义：代理模式给某一个对象提供一个代理对象，并由代理对象控制对原对象的引用。通俗的来讲代理模式就是我们生活中常见的中介。
中介隔离作用：
在某些情况下，一个客户类不想或者不能直接引用一个委托对象，而代理类对象可以在客户类和委托对象之间起到中介的作用，其特征是代理类和委托类实现相同的接口。

开闭原则，增加功能：
代理类除了是客户类和委托类的中介之外，我们还可以通过给代理类增加额外的功能来扩展委托类的功能，这样做我们只需要修改代理类而不需要再修改委托类，符合代码设计的开闭原则。代理类主要负责为委托类预处理消息、过滤消息、把消息转发给委托类，以及事后对返回结果的处理等。代理类本身并不真正实现服务，而是同过调用委托类的相关方法，来提供特定的服务。真正的业务功能还是由委托类来实现，但是可以在业务功能执行的前后加入一些公共的服务。例如我们想给项目加入缓存、日志这些功能，我们就可以使用代理类来完成，而没必要打开已经封装好的委托类。
## 类图

![avatar][Image0]

## 概念代码
```c++
class Componet
{
public:
	virtual void operate() = 0;
};

class ConcreteComponent : public Componet
{
public:
	virtual void operate()
	{
	}
};

class Proxy : public Componet
{
public:
	Proxy(Componet comp)
	{
		m_comp = comp
	}
	virtual void operate()
	{
		m_comp.operate()
	}
private:
	Componet m_comp;
}

int main(int argc, char const *argv[])
{
	Componet* p = new ConcreteComponent();
	p = new Proxy(p);
	p->operate()
}

```

[Image0]:data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAWgAAADJCAIAAACBsD99AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAABxtSURBVHhe7Z0NiFXF+8dFLZVVs1DKMiT9JdnbllRmVJrECgaVELRFRqzoYi/2YltrKZWVVlbQi9VaBukWQSAruJCWBmq0ZeJLJrtpb0oqvvzXSDZ7Mf/fvc/s7Ow5586cu3fOvWfmPh+ul5m53zMv55n53jnXu+f2OHny5NGjR/EcH9brYb2eguj/O3nyRObZTOz6UVt7tUePtoqCeGT01Bm7/RGE9KKf2ZrLu/522DjMsF5P+vS0UOXDQOz6RYVHj/5fTAvI8F9GT8cWzDhEVyNbtHL+2TjMsF5P+vQB4zAs13j1d67GPIzD3BmQ9/mRbdEjiJXz3wOlDOMXrVirHQ+kraDWiUd8un1gt0li+EF4x2GG9XpSqacNAp4tvsNTbW59xhHRYt71t8PGYYb1etKhp6XSvlpKY7ydFEXPxmGG9XpSoJeu0f7IfUfg/fnpghU9G4cZ1utJgZ6NIwes6Nk4zLBeTwr0qnHwpYoBK3o2DjOs15MOPbxDPPKun+rJiu3+B5uLXT8dWByjZOMww3o9HumxDjt3LqIshNX+RLQYr/7OA4tyacbGYYb1ejzSF9g41OY6W4xRf5cD2TgErNfDej156DtXY+YRjdX+qM2xcXSF9XpYr6eAenVBimUcxmp/1BYF8eqXB/JnHB2wXg/r9eSnx4KkR1Zs9yfYXOz6xYG2+xMkUs/GYYb1elivx0s9G4cZ1uthvR4v9WwcZlivh/V6vNSzcZixpX86C7W1tSIVDw/0n376qTgpMfB1PmTDCT3fj6NAYLWMHz/+KSZDWVnZr7/+Kk5NimjNPBK8jUUI2VzBWrQD7zjMWNHjnRYLRmRKnkGDBrW2xv32QQHj9Z/yn6N4RGO1P2pz4v9WCjjeWETq2TjMWNGzcaiwcWQINMfG0RXWAzYOFReMQyzjMFb7I5vrbLGA441FpJ6Nw4wVPRuHSsqMAz2RNoEEPbJioz9qE8EWkx+vBT0bhxkrejYOldQYB5briaPiLuSdS1dPfv1pbzGwxQiQ5HjbsaJn4zBjRc/GoZJK48AjFvn1R7pG1haTHG87VvRsHGas6HM1jvr6+h4dlJeXNzc3ixe8AMaxd+/eP7py/Phx8XJXkoxXwDhibTry6w/vOGLDepCTccyfPx9+sXHjRqTb2tqqq6tT7h2HDx+eNGkSdTgOqTSOWK4B8usPG0dsWA/iGwcMAjYB7xD5jmWplqQN6rODxgH+6/rhqJm8+4O26BFNwuO1o2fjMGNFH9846CIl2yIkE8lcwfRAAlkU0rqtqanB3oTKsSxlmjTwHWjq6uoyh/bAq9jLZKrsclmENBWSvqGhAc8ol3raAZGYCtFVyoKY7pYm42C9gUg9G4cZK/r4xoG1hxUYaRzkGrRcaQGTL5BxACRoGatpWsxULaWpnDxC9Sm1nPTUFmlkOVVOnaEK1UriwMahwQk9G4cZK3orxqEubCCXKxkHrWHVXNS1rVYrNUeOHJHuEzgWejIIlMv6VQHVSceycWjwUs/GYcaK3sqlSuAlyuI5bBxqOmwEshyrVzUCKgdIqHpZPyXQqIQ0bBwavNSzcZixorfy4ShWJtYnVimVy+WqHiLFMi2NQ65tWd69HQdVrlKSxmH4jFOS1v7HJVLPxmHGij6+cQB1katZdWFTGiAR3zioHFUhTQakrnlKUzmUYeNQy1EnaqbKS8844Bfyf1Xx0JHK/udApJ7vx1Egamtr4xsHoLVNyAUMyAuonFwDhTGNA5pc/1clbBzkFyQOdAAlpDEC48Ah+7ty8OBBcbIcgO6jIR8lB+84zFjR57TjSALVCIoO7zg0OKFn4zBjRc/GoeLLZxzkGoaPOdLa/7hE6tk4zFjRs3GouGkcwiky3zTNgdT0X2BFz8Zhxoq+6MaRKhw0js5rk8zfthh2GSrp6H8nVvRsHGas6Nk4VNg4NDihZ+MwY0XPxqHi5qWKahw5kJr+C6zo2TjMWNGzcag4+xlH+0PRU4mB1PRfYEXPxmHGih7GMX78eDwzoKyszEHjEGT08AuxATF6Ryr7nwORejYOM1b0WC38g0wSv4wDDx2p7H8OROrZOMxY0cM4sGBEpuRx81JFkNGzcXg6MA1F0bNxqPhlHHypEg/W64nUs3GouG8cBCxDugZZSYSJpLj/sYjUs3GYsaJn41DxxTgk5BrRGxAX+q8jUs/GYcaKno1DxTvjkK5Bjy640H8dkXo2DjNW9GwcKrzj0OCEnu/HUSByvR+H38A4HL8fR4DWjjt0UMJ/eMdhxoqedxwq3u04iIhPRoE7/Y8mUs/GYcaKHsbB3xyVuP8FsBzwUs/GYcaKHquFvzkqYePQ4ISejcOMFT2MAwtGZEoeTy9VovFSz8ZhxoqejUOFjUODE3o2DjNW9GwcKmwcGpzQs3GYsaJn41Bh49DghJ6Nw4wVvYvGUV9fPy1DzF9LiQ8bhwYn9GwcZqzoU2Uc9PtM9FtK2Whubq6srISGfoEp/q+0xYGNQ4MTejYOM1b0GuPAGra7LI3ADuAFeuNAr+SvuqF76i+/5Q8bhwYn9GwcZqzo4xtH5G8s0tKtqamhcnntgH0B/fYioHVOh9fV1aEcJeHaABJUQu2iNsrK5vCM7Yb8EZZANn/YODQ4oWfjMGNFH984kJVv71j5lIZArnMyC6TJAqhQrm1yCrUG6TJIUBoyugxBWjZB6bAAUJ1qJ/OEjUODE3o2DjNW9GHjIC9QgQtgOalLVNoBSuR2AGB5Y5GjUK55WUiLHAkqVAn7QsARZHmgZkCVi0zesHFocELPxmHGij7mjgOLVm4iKCuNI+wRQFhOBygPe4G8lgEB46DmxGsZ6Gci2Tg0sB6wcZixoo9pHOFlX1FRQSvZuOMg1BooLRc8EgHjCDQnCdfMxiFhPeD7cRQIzf04VOMAWJ9y0co0BNgOkEy6Ce0XqFBagOoFqoDSVJs0DrUJpKEMC4BapxVgHGhC3IejA5fvx1Fy8I7DjBW9ZscRBlZCFw5yl0FLWv6vinzzx/KTVyK0mwgsciToVXIQiPEq3u2RRSHJZHN0nYISNEqXSJk6gtn84R2HBif0bBxmrOhzMo4wZBy0LygM6rWJ9dbZODQ4oWfjMGNF75xxYH+h/xwkH9g4NDihZ+MwY0XvnHEA7Dj4b1XCsB6wcZixos/TODyDjUODE3o2DjNW9GwcKmwcGpzQs3GYsaJn41Bh49DghJ6Nw4wVPYxjwoQJeGYA36xYgxN6Ng4ztvTYcYSZM2fO7Nmz8WzknnvuoURMvaRg+ilTplBCD/QrVqwQbqHAxkE4oWfjMJOoHgtm//79tHKycejQoalTpw4YMGDBggXIGvUBCqNvaGjo37//6aef/uCDD3777bf0UiTZ6mfjIJzQs3GYSVSPBaNfqAsXLuzbt+/7779/1llnNTc3o6QwRhAfqb/wwgu//PLLRYsWjR49+qqrrnr99ddbW1vpJZVs9bNxEE7o2TjMJKrHgsm2kFauXDly5MiHH34YspaWlvPPP5/KC2YEMZH6xYsXV1VV0biamppmzJjRu3fvysrKxsZGEhDZ6mfjIJzQs3GYSVSPBRNeSLt377755ptvvPHGXbt2keztt9+eNm0avVowI4iJqh80aBB2GdRnYvny5RMmTBg+fPjcuXP1OyY2DsIJPRuHmUT1WDCBhVRbW4urkhUrVghFhttuuw0rkASFNII4qHq4w7x580SnFX7++WeUDxs2bOLEiTBBoe4KGwfhhJ6Nw0yieiwYufCWLVs2ePDgZ555RrymcMYZZ/z6668kS7NxHDhwoKysTHQ6ijVr1tx+++39+vWbPn36+vXrxWEZ2DgIJ/R8P45U8M0331x//fXYVhw6dEhERmHLli2XXnqpkKaeqqqqd955R3Q9C21tbYsXLx4zZszFF1+8cOHCPXv2iIMZR+Adh5mk9dXV1RdccMG6detEPsTLL788e/ZskUn9eFtaWkaNGiUyJrZt2/bQQw8NHDjwtdde+/3330VpV1I+XiNe6tk4zCSnX7JkSe/evbFmRD4LkydPbmxsFBkXxnvTTTetWrVKZGLwwAMP1NbWikyI9I9Xj5d6Ng4zSei/+uqryy67DNf5//zzjyjKTp8+fdTr//SPF7unG264QWRMPPHEE88//7zIRJH+8erxUs/GYca6ftq0aVdfffWWLVtEXsuXX355zTXXiEwGJ8YLW4wzwBdeeOHxxx8XmSw4MV4NXurZOMxY15966qlffPGFyJiYP39+4D84nRjv8uXL77rrLpHJwltvvTVz5kyRyY4T49XgpZ6Nw0wSevpLWZHRAmXAZVwZ75AhQw4ePCgyIeI4C+HKeLPhpZ6Nw0xC+qeeemrixIkik4UTJ0707NlTZDpwZbwLFy7M9pHnxx9/fPPNN4uMCVfGmw0v9WwcZpLTr127tlevXpr7AH/22Wc33nijyHTgynj//vvvU045RWQUsIG66qqrLrroIpE34cp4s+Glno3DTKL6f//9d9y4cc8++6zIdwXv2HjfFpkOHBrv/fff/8Ybb4hMhs2bN19++eVI7Nix49xzz6VCPQ6NNxIv9WwcZgqgHzx4cEVFhcgr4J3566+/FpkOHBrvTz/9dN5554nMyZM//PDD+eefL/V79uw57bTTKK3BofFG4qWejcNM0npYRmNj4+rVq/v27avaxB9//NG/f3+RUXBrvFOmTKE/2Dtw4MCZZ56JhKpHumfPnseOHRP5KIrb/zCsB2wcZhLVv/jiiw8++CCl//zzT2wxXnrpJcquXLky8hNEt8a7YcOGa6+9tq2trV+/flQS0J84caKsrGzfvn0iH8Kt8YbxUs/GYSY5fVNT09ixYwP6mpqam266CYlZs2ZFfhvdufFeeeWVvXr1kt+RjdQPHTq0paVFZLri3HgDeKln4zCTnJ6+Sx7Wr1q1ChcpF1xwwXfffSeKFJwb7/79+9U/YMumHzVq1KZNm0RGwbnxBvBSz8ZhJiF9RUXF6tWrkYjUHzly5LHHHhOZrjg6XolGf8UVV6xdu1ZkOvB4vJE4oef7cRSHuXPnPvrooyLDKFx//fUffvihyDBphXccZqzr6fNCkSmB8QYw6m+99dZly5aJTAmMN4ATejYOM9b1PXv2PHHihMiUwHgDxNFPnTr1zTffpHQpjFfFCT0bhxm7+htuuCFwsy+/xxsmpv6+++5bsGABEiUyXokTejYOMxb1T0f99LTH440kvp5+MrJ0xks4oWfjMGNLn+2+WL6ONxs56bHpmD59usjEo6TODyiKno3DjBV95B/IE16OV0Ou+kWLFk2dOlVkYlBq56coejYOM1b011577YYNG0SmK16OV0M39MuWLbvllltE3oQH4xWpeBRFz8ZhJn/9k08++dxzz4lMCP/Gq6d7+oaGBuN9jwg/xhufoujZOMzkqV+9enXkn8xLPBuvkW7r165de8UVV1BagzfjjUlR9GwcZvLRHz9+vE+fPiKTBZ/GG4d89Js2bTL+2pNP441DUfRsHGby0Y8dO7apqUlksuDTeOOQp76lpWXo0KEiE4Vn4zVSFD0bh5lu6x977LEXX3yR0hq8GW9M8tfv27evrKxM/fatin/j1VMUPRuHme7pGxsbJ0+eTCV6/BhvfKzojx071rNnz9bWVpFX8HK8GoqiZ+Mw0w19trv+ReLBeEUqHhb1gwYN2rNnj8h04PF4IymKno3DTDf0Y8aM2bx5s8ib8GC8IhUPu/pzzz13x44dIpPB7/GGKYqe78dhn3vvvXfBggUiwyTP6NGj16xZIzJMQeAdh5mc9A0NDXTH0PiU1PkBSejHjRtHt1MDpTBelaLo2TjMxNe3trbiqrt0xkukRF9RUfHJJ58gUSLjlRRFz8ZhJr7+kksu2b59e+mMl0iP/rbbblu6dGnpjJcoip6Nw0xMvfy5wxIZryRV+qqqqvCPZuopqfMDrOjZOMzE0WOTjLc7SpfCeFXSpp85c+b8+fNFJgaldn6s6Nk4zBj1Bw8eHDJkiMiUwHgDpFA/b968Rx99VORNeDBekYqHFT0bhxmjfvTo0Tt37hSZEhhvgHTqFy1aNGPGDCrR48d442NFz8ZhRq+vrq5+5513RCaD3+MNk1p9XV3dHXfcQWkN3ow3Jlb0bBxmNPqPPvooPDU9Hm8kadYjQMav1fg03jhY0bNxmMmm/+23384++2yRUfB1vNlIuX7VqlXXXXedyETh2XiNWNGzcZjJpv/f//63a9cukVHwdbzZSL9+/fr15eXlIhPCv/HqsaJn4zATqZ82bdp7770nMl3xcrwanNBv3bp1xIgRItMVL8erwYqejcNMWP/BBx/cfffdIhPCv/HqcUX/448/Dh48WGQUfB1vNqzo2TjMBPS//PLL8OHDRSYKz8ZrxCH9oUOHTj31VJHpwOPxRmJF3x3jqK2tfToXWK+ne/rt27eLeJhwYiICGl0Yu+dz3rx5ItVBYeIVn+Lqw/MqMl45348DrY4fP/4ppqg88MADw4YNEyHxAp5XaSD+vMp5xwFPQgMiwxSJ3bt3jxw5UmRM5BRfUBQ9z6s0EDmvIuPFxuEkbBxMErBxeA4bB5MEbByew8bBJAEbh+ewcTBJwMbhOWwcTBIUwTg2btzYQwFZ8ULKOHz48KRJk0Qve/TI6VZR6QEBHjFixB8h/v77b6FQKIoRaIjUp804mpuby8vLxSzJgGmDySNe9pTIebV///7wvLJjHPX19TizeKYsViOyhfcOtKs3ApoN1dXVbW1tyJLZ6Q8pOuhzRUUFnkU+AxtH0gSmCr3feO8dBTUOOqfyFAMkkFVLCgA1qncBvIrZoC5CmF2gJG3A3cI9ZONImoBxgPDk8Y+CGge9b8vtRhiccQgI2obQIofdNDQ0ULlc8PQSFco4Uczq6upQSDXIOulNgMxLLaHAUwn1jTQaO6N9E6HunmTTVE7jpTQE1FBNTY3sNvUQhHsl9ahWDkHqw32O7BJg40gaikWkcdAEePXVVxFTFEoxhYkOATQfKLh0SCbmne5DGjkx0kBBjYMmtzqtVdQzRUqcRHla8Spp5CmWevW0koDEIFAPQIKCRxrVIyhmeCYBFVI9KrJOpOkQGpFsmtpS09RPqpbSVE59VvuglpOe2iINlVOa9LLP1AGqvL2XHbBxJA2FicIRyFJ0KGrypfDEAxT0lpaWQGRpaqkHpoS0GId6HpGVZ0qeUzr18mwG9BJ18QSOxVH0kqwchWp4qE6UkyBcOQjUqXZDbZpGSus50K6sVmrUPqjlpKd+Alm/qpd9VgUZuYCNI2koTIiIRIY4W2Qpq8ZLVhI5tQIHpoGCGkfgPKrQiZOLhLI4a0eOHMGzPJuyhoBeogaDTj30KqhBPZZCooLm9u7dK2OWqbUTNZwyC5BQm0a1ahrVBtpVy2VCLcdzQC/rJ4EK9UftgISNI2koTJGzRU5XygYChCxelXGnrBQDpEmPlyLrLyIFNY7AqgNIIAsCa5WCgfNFAlqZKJeRCFdFqLGRlQc0snKkqUIZPIlaD0FR3Lp1KyqU/VG7oR4iQ05paoLalf2R5UCdMQE99RPI+kmPZyqXhPsM2DiSJhBWlWyRpawaL1ISUkA100ckspKUUFDjAHTuAqeSsup5RJrOIC3+sHGoelUTWDxUP0UCL5GG4oEsCtWVT+VUOaXlbFCzap2UDvSHytU06akSKlf7rPaB0lROeuonkPWretKEOyBh40gaCoGcKirqdAVqQNWjZECRwDNFHxqaJKghHNaik4NxIIo5UVtbGxlgOmU4HQStQALnVJR2lNO5k6dSjYQ8rUCe2fDikXXKcnmguj5JQ0El1PqB+hJ5ASGnhdo0CtU0ZNI4uvG/KqRR66eXSC8FdHKA7BJAgM877zxENACaEHFyjWzzqlhQLBBTTBhR1IE6XQk1cHQITTMZWTpE1hbIpof488rOjqOUoUmjGlAB4B2H04StJyXksOPAPzaOfGDjYOPICdqMyB1oqmDjKBxsHGwc8ZEXnkiIojTBxuE5bBxMErBxeA4bB5MEbByew8bBJAEbh+fojeP48eOvvPLKjz/+SGI2DiYmyRrH+PHj8cwUkVmzZg0bNkwEVqGpqamqqqpPnz6PPPKIDLYrxsHzquhEziubxoE3B6aIIMDnnHOOCGyGurq6K6+8csyYMUuXLhWh6sAh4xDDY4pEeF4BvlTxB7ml/P777x966KGysrI777xz3bp14QADV4yD51XR4c84PIcCfNZZZ5122mnz588/cOAAAvzEE0/QD6MKUSZYoLa2VuQ7SoDIR5VAHyihLBD5riU0f0Q+xlGR/QE8r4oOG4fnUICHDh06cOBAGMe+ffsQ4Dlz5sA41OggDdSFSiVA5KNK6M9G1BLKApHvWkLzR+RjHBXZH55XaYCNw3NkgHfu3Pnwww8PGDCgsrLy888/50sVJh/YODwnHOB333137Nix5eXlS5YsEaIO2DiYmLBxeE5kgMGmTZumT5/eu3fvWbNm/fXXXyRm42BikoNxIIo5QRfA4mimSCDAmvsm4PmFF17Ytm0bhcwJeF6lAf28UuEdh5Nk23HwZxxMPuSw48C/XI2Dv+FXdLJ9c9Rp4+B5VXT4m6OeE/kNP+C6cYjhMUWCvznqOXypwiRBspcqHOCiw8bBJAEbh+ewcTBJwMbhOWwcTBKwcXShvr5+WoYC31I4Odg40kCJzCsPjaMt8xON+tvMNzc3V1ZWQkO3pU/n3aVzhY0jUXheqSRuHDjXBT59CBtipg8weiV/+QbdS+HPZ3WDkjIOnlcFIxXGQU5MvyKh/tojCmtqaqgch5CYfp2ECikedHhdXR3KURKuDcgfWKR2URtlZXN4xtsCKm9vI5R1l1I2Dp5XyZEK40AWIUFgkEaEKA2BjAcFFWkKFRXKGFBE1RrkbECC0pBBTLGUTVA6LABUp9pJRyll40BWDTSlIeB5lT8FNQ6KmQqitXfvXvVUyrChRNo2QBgQDBTK2MhCCgYSVKgSjl8gcrI8UDOgykXGWUrBOBA7MZ864HmVNMXfceDkSrOnrAxwOJZATI0OUB6OmdxzgkCAqTnxWgaIw80BjwMMvN9xUKB5XiVE8Y0jHJ6Kigo648Z3BkKtgdIyMEgEAhxoThKu2eMAA++NIxBonld2ycE4EMWc0Nw3QQ0wwHmUJ1emIYBtk0xGnXydCmWo1JipAkpTbTLAahNIQxkWALVOp0GAY943wRV4XqWB+PPK5o4jDEKe2d9l/fQbUSElIiF3jOT6gWAgQa9SpCHGq7jiRRaFJJPN0X4SJWgUAaZ0OOsuJbXjCMPzKiFy2HHgX3LGEYYCTP5dGBB1OY0K33pClLhxhOF5ZQU2jk7wPkC7SjSKptEB8YLLsHEE4HllBTaOLuCdoRT+pgCwcYh8QSiReZUK42CswMbBJAEbh+ewcTBJwMbhOWwcTBIkaxwTJkzAM1NEvLzLOc+ropPgXc4BfVcnwJzszJ49W6TiwXo9pP/qq69EYBXcNQ4gZlJX5Hjjw3o9en14Xlkzjki9aCQKNCxS8WC9Ho3eaeOIBIPyOF6RpFDPxtGOx3o2DsB6Pd3Qs3G047GejQOwXk839Gwc7XisZ+MArNfTDT0bRzse69k4AOv1dEPPxtGOx3o2DsB6Pd3QRxgHosgwDJMT1nYcGlivh/V6WK+nKHo2DjOs18N6PV7q2TjMsF4P6/V4qWfjMMN6PazX46WejcMM6/WwXo+H+pMn/x/pq+Z08AfP1wAAAABJRU5ErkJggg==