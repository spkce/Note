```c++
#include <stdio.h>
#include <string.h>
#include <unistd.h>
#include <stdlib.h>
#include <stdint.h>

#define PTR_SIZE 8   // 指针的大小
#define EBP_SIZE 8   // ebp寄存器的大小

void inject_callback()
{
    printf("inject_callback called...\n");
    exit(0);
}

void func_call(char *addr, int len)
{
    char tmpBuf[16] = {(char)0xff};

    memcpy(tmpBuf + 16 + EBP_SIZE, addr, len);

    printf("func_call called...\n");
}

int main(int argc, char** argv)
{
    uint64_t injectPtr = (uint64_t)&inject_callback;

    func_call((char*)&injectPtr, PTR_SIZE);

    printf("main exited...\n");

    return 0;
}

```

在编译上面程序时，一定要加上 -fno-stack-protector 参数，否则将会触发栈溢出保护，导致执行失败。

```c++
spkce@pc-spkce:~/source/tmp$ g++ a.cpp -g -fno-stack-protector
spkce@pc-spkce:~/source/tmp$ ./a.out
func_call called...
inject_callback called...
```